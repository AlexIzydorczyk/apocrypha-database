<script type="text/javascript">
let modernSourcesVue;
$(document).ready(function(){
	modernSourcesVue = new Vue({
		name: 'modernSourcesVue',
		el: '#modern-source-form',
		data: {
			author_type: '<%= modern_source.author_type %>',
			sources: <%= modern_source.source_urls.map{ |ms| {url: ms.url, accessed: (ms.date_accessed.present? ? format_date(ms.date_accessed) : '')} }.to_json.html_safe %>,
			source_type: '<%= modern_source.source_type %>',
		},
		computed: {
			title_orig_label(){
				switch(this.source_type){
					case 'journal_article':
						return "Article title";
					case 'unpublished_document':
						return 'Document title';
					case 'web_page':
						return "Title of webpage";
					case "handwritten_document":
						return "Document title";
					case "book_chapter":
						return "Chapter title"
					default: 
						return 'Book title in original language';
				}
			},
		},
		mounted(){
			
			runTomSelects();

		    $( ".accessed-field" ).datepicker({
		      changeMonth: true,
		      changeYear: true,
		      dateFormat: "d MM, yy",
		      maxDate: "+0"
		    });
		
		},
	});
});

function runTomSelects(){
	new TomSelect("#modern_source_source_type",{
		sortField: {
			field: "text",
			direction: "asc",
		},
		maxItems: 1,
	});
	new TomSelect("#author_reference_id",{
		sortField: {
			field: "text",
			direction: "asc",
		},
		maxItems: null,
		lockOptgroupOrder: true,
	});
	new TomSelect("#modern_source_institution_id",{
		sortField: {
			field: "text",
			direction: "asc"
		},
		maxItems: 1,
	});
	new TomSelect("#editor_reference_id",{
		sortField: {
			field: "text",
			direction: "asc",
		},
		maxItems: null,
		lockOptgroupOrder: true,
	});
	new TomSelect("#translator_reference_id",{
		sortField: {
			field: "text",
			direction: "asc",
		},
		maxItems: null,
		lockOptgroupOrder: true,
	});
	new TomSelect("#modern_source_publication_location_id",{
		sortField: {
			field: "text",
			direction: "asc"
		},
		maxItems: 1,
	});
	new TomSelect("#modern_source_document_type",{
		sortField: {
			field: "text",
			direction: "asc"
		},
		maxItems: 1,
		create: true,
	});
	new TomSelect("#modern_source_publisher",{
		sortField: {
			field: "text",
			direction: "asc"
		},
		maxItems: 1,
		create: true,
	});
	new TomSelect("#modern_source_edition",{
		sortField: {
			field: "text",
			direction: "asc"
		},
		maxItems: 1,
		create: true,
	});
};
</script>
